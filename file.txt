some code
changes made by john